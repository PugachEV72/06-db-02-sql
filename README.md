# Домашнее задание к занятию 2. «SQL» - Пугач Евгений.


---

## `Задание 1`

Приведите получившуюся команду или docker-compose-манифест.

### Ответ:

![Скриншот 1](https://github.com/PugachEV72/Images/blob/master/2023-06-24_22-35-16.png)

![Скриншот 2](https://github.com/PugachEV72/Images/blob/master/2023-06-24_22-52-37.png)

---

## `Задание 2`

Приведите:

- итоговый список БД после выполнения пунктов выше;
- описание таблиц (describe);
- SQL-запрос для выдачи списка пользователей с правами над таблицами test_db;
- список пользователей с правами над таблицами test_db.

### Ответ:

![Скриншот 3](https://github.com/PugachEV72/Images/blob/master/2023-06-25_02-06-17.png)

![Скриншот 4](https://github.com/PugachEV72/Images/blob/master/2023-06-25_02-07-17.png)

---

## `Задание 3`

Приведите:

- запросы,
- результаты их выполнения.

### Ответ:

![Скриншот 5](https://github.com/PugachEV72/Images/blob/master/2023-06-25_02-41-08.png)

---

## `Задание 4`

Приведите SQL-запросы для выполнения этих операций.  
Приведите SQL-запрос для выдачи всех пользователей, которые совершили заказ,  
а также вывод этого запроса.

### Ответ:

![Скриншот 6](https://github.com/PugachEV72/Images/blob/master/2023-06-25_02-48-19.png)

![Скриншот 7](https://github.com/PugachEV72/Images/blob/master/2023-06-25_03-27-09.png)

---

## `Задание 5`

Получите полную информацию по выполнению запроса выдачи всех пользователей из задачи 4  
(используя директиву EXPLAIN).  
Приведите получившийся результат и объясните, что значат полученные значения.

### Ответ:

![Скриншот 8](https://github.com/PugachEV72/Images/blob/master/2023-06-25_03-32-17.png)

Запрос читается снизу вверх. План запроса измеряется в так называемых (условных) единицах  
стоимости (cost). Чем выше значения стоимости, тем дольше будет выполняться запрос. Атрибут  
rows указывает на количество обрабатываемых строк.  

Ключевые операторы:  
Seq Scan — последовательный перебор строк таблицы;  
Hash Cond — условие для соединения с помощью хеш-таблицы;  
Hash Join — соединение с помощью хеш-таблицы.  

Если я правильно понял, примерно так:  
1. Построчно прочитана таблица clients;
2. Создан кеш по полю id для таблицы clients;
3. Построчно прочитана таблица orders;
4. Для каждой строки по полю "заказ" будет проверено, соответствует ли она чему-то в кеше orders:
- если соответствия нет - строка будет пропущена;
- если соответствие есть, то на основе этой строки и всех подходящих строк кеша, СУБД сформирует  
вывод.
 
При запуске explain, Postgres напишет примерный план выполнения запроса и для каждой операции  
предположит:
- сколько процессорного времени уйдёт на поиск первой записи и сбор всей выборки: cost;
- сколько примерно будет строк: rows;
- какой будет средняя длина строки в байтах: width.

---

## `Задание 6`

Приведите список операций, который вы применяли для бэкапа данных и восстановления.

### Ответ:

![Скриншот 9](https://github.com/PugachEV72/Images/blob/master/2023-06-25_03-41-03.png)

![Скриншот 10](https://github.com/PugachEV72/Images/blob/master/2023-06-25_12-52-27.png)

![Скриншот 11](https://github.com/PugachEV72/Images/blob/master/2023-06-25_08-42-39.png)

---

